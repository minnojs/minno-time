define("extensions/iat/data/properties",[],function(){return{DEBUG:!0,font:"Arial",fontSize:"2em",fontColor:"#31b404",defaultStimulus:{},instructionsStimulus:{css:{"font-size":"1.3em",color:"black",lineHeight:1.2,"text-align":"left",margin:"25px"}},background:"#EEEEEE",canvas:{maxWidth:800,proportions:.8},left:"e",right:"i",leftTouch:void 0,rightTouch:void 0,notouch:!0,timeout:0,randomize_order:!0,IATversion:"long",inter_trial_interval:250,post_instructions_interval:500,correct_errors:!0,error_feedback:{active:!0,media:"X",duration:"static"},correct_feedback:{active:!1,media:"OK",duration:300},timeout_feedback:{active:!0,media:"X",duration:500},simpleLayout:!0,separatorColor:"black",separatorSize:"1em",separator:{media:"or",height:5,css:{fontSize:"1.2em"}},endMedia:void 0,pulse:20,images_base_url:"",templates_base_url:"extensions/iat/jst"}}),define("extensions/iat/data/categories",[],function(){return{}}),define("extensions/iat/trial/input_decorator",["../data/properties"],function(e){var t=function(t){var a=t.input,r=t.interactions;switch(e.DEBUG&&a.push({handle:"skip1",on:"keypressed",key:27}),typeof e.left){case"undefined":a.push({handle:"left",on:"keypressed",key:"e"});break;case"string":case"number":a.push({handle:"left",on:"keypressed",key:e.left});break;default:e.left.handle="left",a.push(e.left)}switch(typeof e.right){case"undefined":a.push({handle:"right",on:"keypressed",key:"i"});break;case"string":case"number":a.push({handle:"right",on:"keypressed",key:e.right});break;default:e.right.handle="right",a.push(e.right)}if(!e.notouch){switch(typeof e.leftTouch){case"undefined":a.push({handle:"left",on:"leftTouch",touch:!0});break;default:a.push({handle:"left",on:"click",element:e.leftTouch,touch:!0})}switch(typeof e.rightTouch){case"undefined":a.push({handle:"right",on:"rightTouch",touch:!0});break;default:a.push({handle:"right",on:"click",element:e.rightTouch,touch:!0})}}return e.timeout&&(a.push({handle:"timeout",on:"timeout",duration:e.timeout}),r.push({conditions:[{type:"inputEquals",value:"timeout"}],actions:[{type:"removeInput",handle:["left","right"]},{type:"setTrialAttr",setter:{score:9}},{type:"log"},{type:"trigger",handle:"timeout_feedback"}]})),t};return t}),define("extensions/iat/trial/feedback_decorator",["../data/properties"],function(e){var t=function(t){for(var a=["correct","error","timeout"],r=t.interactions,i=0;i<a.length;i++){var n=a[i]+"_feedback",o=e[n]||{};r.push(o.active?{conditions:[{type:"inputEquals",value:n}],actions:[{type:"showStim",handle:n},{type:"setInput",input:{handle:"remove_"+n,on:"timeout",duration:o.duration>=0?o.duration:300}}]}:{conditions:[{type:"inputEquals",value:n}],actions:[{type:"trigger",handle:"remove_"+n}]}),"error_feedback"===n&&e.correct_errors?"static"!==o.duration&&r.push({conditions:[{type:"inputEquals",value:"remove_"+n}],actions:[{type:"hideStim",handle:n}]}):r.push({conditions:[{type:"inputEquals",value:"remove_"+n}],actions:[{type:"trigger",handle:"end"}]})}return t};return t}),define("extensions/iat/trial/default",["../data/properties","./input_decorator","./feedback_decorator"],function(e,t,a){function r(){var r={data:{score:0},input:[],layout:[{inherit:{type:"byData",set:"layout",data:"left"}},{inherit:{type:"byData",set:"layout",data:"right"}}],interactions:[{conditions:[{type:"begin"}],actions:[{type:"showStim",handle:"target"}]},{conditions:[{type:"inputEqualsStim",property:"side",handle:"target"}],actions:[{type:"removeInput",handle:["left","right","timeout"]},{type:"hideStim",handle:"error_feedback"},{type:"log"},{type:"trigger",handle:"correct_feedback"}]},{conditions:[{type:"inputEquals",value:"end"}],actions:[{type:"hideStim",handle:"All"},{type:"setInput",input:{handle:"endTrial",on:"timeout",duration:e.inter_trial_interval||0}}]},{conditions:[{type:"inputEquals",value:"endTrial"}],actions:[{type:"endTrial"}]},{conditions:[{type:"inputEquals",value:"skip1"}],actions:[{type:"setInput",input:{handle:"skip2",on:"enter"}}]},{conditions:[{type:"inputEquals",value:"skip2"}],actions:[{type:"goto",destination:"nextWhere",properties:{blockStart:!0}},{type:"endTrial"}]}],stimuli:[]},i={conditions:[{type:"inputEqualsStim",property:"side",handle:"target",negate:!0},{type:"inputEquals",value:["right","left"]}],actions:[{type:"trigger",handle:"error_feedback"},{type:"setTrialAttr",setter:{score:1}}]};return e.correct_errors||i.actions.unshift({type:"removeInput",handle:["left","right","timeout"]}),r.interactions.push(i),a(r),t(r),r}return r}),define("extensions/iat/stimuli/separator",["../data/properties"],function(e){return function(t,a){var r=e.separator,i={media:r.media,css:r.css||{color:"black"}},n=r.margin||0;switch(t){case"left":i.location={left:2+n,top:a};break;case"right":i.location={right:2+n,top:a};break;case"center":i.location={top:a}}return i}}),define("extensions/iat/stimuli/category",["../data/categories"],function(e){return function(t,a,r){var i=e[t],n=i.margin||0;if(!i)throw new Error(t+" is not a category name (or has not been loaded yet)");var o=i.title||i.name,s={media:o,css:i.titleCss||{fontSize:"1.3em",color:"black"},height:i.height||5};switch(a){case"left":s.location={left:2+n,top:r};break;case"right":s.location={right:2+n,top:r};break;case"center":s.location={top:r};break;default:throw new Error("Unknow side in category")}return s}}),define("extensions/iat/trial/layout",["underscore","../data/properties","../stimuli/separator","../stimuli/category"],function(e,t,a,r){var i=function(i){var n=[];return e.each(i,function(i,o){var s=2;e.each(i,function(i,c){var l,u;c>0&&e.isObject(t.separator)&&(l=new a(o,s),n.push(l),s+=t.separator.height||4),u=new r(i,o,s),n.push(u),s+=u.height})}),n};return i}),define("extensions/iat/trial/simple_layout",["underscore","../data/properties","../data/categories"],function(e,t,a){var r=function(r){var i=[];return e.each(r,function(r,n){var o={media:{template:"layout.jst"},data:{separatorColor:t.separatorColor,separatorSize:t.separatorSize}},s=o.data;switch(n){case"left":o.location={left:2,top:2};break;case"right":o.location={right:2,top:2};break;default:throw new Error("Unknow side")}e.each(r,function(t){var i=t.replace(/[0-9]/g,""),n=a[t],o=e.isObject(n.title)?n.title.word:n.title;if(!o)throw new Error("We are missing a title for "+r+". are you using an advanced media type by any chance?");s[i]=o,n.titleColor&&(s[i+"Color"]=n.titleColor),n.titleSize&&(s[i+"Size"]=n.titleSize)}),i.push(o)}),i};return r}),define("extensions/iat/trial/IATlayout",["../data/properties","./layout","./simple_layout"],function(e,t,a){var r={1:{left:["concept1"],right:["concept2"]},2:{left:["attribute1"],right:["attribute2"]},3:{left:["attribute1","concept1"],right:["attribute2","concept2"]},4:{left:["attribute1","concept1"],right:["attribute2","concept2"]},5:{left:["concept2"],right:["concept1"]},6:{left:["attribute1","concept2"],right:["attribute2","concept1"]},7:{left:["attribute1","concept2"],right:["attribute2","concept1"]}};return function(i){return e.simpleLayout?a(r[i]):t(r[i])}}),define("extensions/iat/trial/instructions",["underscore","../data/properties","../data/categories","./IATlayout"],function(e,t,a,r){function i(){var e={data:{block:"generic"},input:[{handle:"space",on:"space"}],interactions:[{conditions:[{type:"begin"}],actions:[{type:"showStim",handle:"All"}]},{conditions:[{type:"inputEquals",value:"space"}],actions:[{type:"hideStim",handle:"All"},{type:"setInput",input:{handle:"endTrial",on:"timeout",duration:t.post_instructions_interval||0}}]},{conditions:[{type:"inputEquals",value:"endTrial"}],actions:[{type:"endTrial"}]},{conditions:[{type:"inputEquals",value:"skip1"}],actions:[{type:"setInput",input:{handle:"skip2",on:"enter"}}]},{conditions:[{type:"inputEquals",value:"skip2"}],actions:[{type:"goto",destination:"nextWhere",properties:{blockStart:!0}},{type:"endTrial"}]}]};return t.DEBUG&&e.input.push({handle:"skip1",on:"keypressed",key:27}),t.notouch||e.input.push({handle:"space",on:"bottomTouch",touch:!0}),e}function n(){for(var n,c,l,u=i(),d=[u],p=function(){this.layout=r(this.data.part)},f=1;7>=f;f++)l=s[f]||{},n={data:{block:f},inherit:{set:"instructions",type:"byData",data:{block:"generic"}},customize:p},c={inherit:"instructions",media:{template:"inst"+f+".jst"}},l.media&&(c.media=l.media),l.template&&(c.media={inlineTemplate:l.template}),l.css&&(c.css=l.css),l.extend&&e.extend(n,l.extend),n.stimuli=[c],d.push(n);return e.each(a,function(e,t){u.data[t]=e.name,u.data[t+"Color"]=e.titleColor}),o.stimuli.push({inherit:"instructions",media:t.endMedia||{html:'<div><p style="font-size:1.4em"><color="#FFFAFA">You have completed this task<br/><br/>Thank you very much for your participation.<br/><br/> Press "space" in order to continue.</p></div>'}}),d.push(o),d}var o={data:{block:"last"},input:[{handle:"space",on:"space"}],interactions:[{conditions:[{type:"begin"}],actions:[{type:"showStim",handle:"All"}]},{conditions:[{type:"inputEquals",value:"space"}],actions:[{type:"endTrial"}]}],stimuli:[]},s=[];return function(e,t){return arguments.length?void(s[e]=t):n()}}),define("extensions/iat/trial/trials",["../data/categories","./default","./instructions","./IATlayout"],function(e,t,a,r){return function(){var i={},n=e.attribute1.name,o=e.attribute2.name,s=e.concept1.name,c=e.concept2.name;return i.Default=[t()],i.instructions=a(),i.IAT=[{data:{part:1,condition:s+","+c},layout:r(1),inherit:"Default",stimuli:[{inherit:{type:"exRandom",set:"concept1_left"}},{inherit:{type:"exRandom",set:"feedback"}},{inherit:{type:"exRandom",set:"feedback"}},{inherit:{type:"exRandom",set:"feedback"}}]},{data:{part:2,condition:n+","+o},layout:r(2),inherit:"Default",stimuli:[{inherit:{type:"exRandom",set:"attribute1_left"}},{inherit:{type:"exRandom",set:"feedback"}},{inherit:{type:"exRandom",set:"feedback"}},{inherit:{type:"exRandom",set:"feedback"}}]},{data:{part:3,row:1,condition:n+"/"+s+","+o+"/"+c,parcel:"first"},layout:r(3),inherit:"Default",stimuli:[{inherit:{type:"exRandom",set:"concept1_left"}},{inherit:{type:"exRandom",set:"feedback"}},{inherit:{type:"exRandom",set:"feedback"}},{inherit:{type:"exRandom",set:"feedback"}}]},{data:{part:3,row:2,condition:n+"/"+s+","+o+"/"+c,parcel:"first"},layout:r(3),inherit:"Default",stimuli:[{inherit:{type:"exRandom",set:"attribute1_left"}},{inherit:{type:"exRandom",set:"feedback"}},{inherit:{type:"exRandom",set:"feedback"}},{inherit:{type:"exRandom",set:"feedback"}}]},{data:{part:4,row:1,condition:n+"/"+s+","+o+"/"+c,parcel:"second"},layout:r(4),inherit:"Default",stimuli:[{inherit:{type:"exRandom",set:"concept1_left"}},{inherit:{type:"exRandom",set:"feedback"}},{inherit:{type:"exRandom",set:"feedback"}},{inherit:{type:"exRandom",set:"feedback"}}]},{data:{part:4,row:2,condition:n+"/"+s+","+o+"/"+c,parcel:"second"},layout:r(4),inherit:"Default",stimuli:[{inherit:{type:"exRandom",set:"attribute1_left"}},{inherit:{type:"exRandom",set:"feedback"}},{inherit:{type:"exRandom",set:"feedback"}},{inherit:{type:"exRandom",set:"feedback"}}]},{data:{part:5,condition:c+","+s},layout:r(5),inherit:"Default",stimuli:[{inherit:{type:"exRandom",set:"concept1_right"}},{inherit:{type:"exRandom",set:"feedback"}},{inherit:{type:"exRandom",set:"feedback"}},{inherit:{type:"exRandom",set:"feedback"}}]},{data:{part:6,row:1,condition:n+"/"+c+","+o+"/"+s,parcel:"first"},layout:r(6),inherit:"Default",stimuli:[{inherit:{type:"exRandom",set:"concept1_right"}},{inherit:{type:"exRandom",set:"feedback"}},{inherit:{type:"exRandom",set:"feedback"}},{inherit:{type:"exRandom",set:"feedback"}}]},{data:{part:6,row:2,condition:n+"/"+c+","+o+"/"+s,parcel:"first"},layout:r(6),inherit:"Default",stimuli:[{inherit:{type:"exRandom",set:"attribute1_left"}},{inherit:{type:"exRandom",set:"feedback"}},{inherit:{type:"exRandom",set:"feedback"}},{inherit:{type:"exRandom",set:"feedback"}}]},{data:{part:7,row:1,condition:n+"/"+c+","+o+"/"+s,parcel:"second"},layout:r(7),inherit:"Default",stimuli:[{inherit:{type:"exRandom",set:"concept1_right"}},{inherit:{type:"exRandom",set:"feedback"}},{inherit:{type:"exRandom",set:"feedback"}},{inherit:{type:"exRandom",set:"feedback"}}]},{data:{part:7,row:2,condition:n+"/"+c+","+o+"/"+s,parcel:"second"},layout:r(7),inherit:"Default",stimuli:[{inherit:{type:"exRandom",set:"attribute1_left"}},{inherit:{type:"exRandom",set:"feedback"}},{inherit:{type:"exRandom",set:"feedback"}},{inherit:{type:"exRandom",set:"feedback"}}]}],i}}),define("extensions/iat/stimuli/stimuli",["underscore","../data/properties","../data/categories"],function(e,t,a){return function(){var r,i,n={};r=t.defaultStimulus,r.css=e.defaults(r.css||{},{font:t.font,fontSize:t.fontSize,color:t.fontColor}),n.Default=[r],n.instructions=[t.instructionsStimulus],n.attribute1=[e.extend(a.attribute1.stimulus||{},{inherit:"Default",css:a.attribute1.css||r.css})],n.attribute2=[e.extend(a.attribute2.stimulus||{},{inherit:"Default",css:a.attribute2.css||r.css})],n.concept1=[e.extend(a.concept1.stimulus||{},{inherit:"Default",css:a.concept1.css||r.css})],n.concept2=[e.extend(a.concept2.stimulus||{},{inherit:"Default",css:a.concept2.css||r.css})],e.extend(n,{attribute1_left:[],attribute1_right:[],concept1_left:[],concept1_right:[]});for(var o=0;5>o;o++)n.attribute1_left=n.attribute1_left.concat([{data:{side:"left",handle:"target",alias:a.attribute1.name},inherit:"attribute1",media:{inherit:{type:"exRandom",set:"attribute1"}}},{data:{side:"right",handle:"target",alias:a.attribute2.name},inherit:"attribute2",media:{inherit:{type:"exRandom",set:"attribute2"}}}]),n.attribute1_right=n.attribute1_right.concat([{data:{side:"left",handle:"target",alias:a.attribute2.name},inherit:"attribute2",media:{inherit:{type:"exRandom",set:"attribute2"}}},{data:{side:"right",handle:"target",alias:a.attribute1.name},inherit:"attribute1",media:{inherit:{type:"exRandom",set:"attribute1"}}}]),n.concept1_left=n.concept1_left.concat([{data:{side:"left",handle:"target",alias:a.concept1.name},inherit:"concept1",media:{inherit:{type:"exRandom",set:"concept1"}}},{data:{side:"right",handle:"target",alias:a.concept2.name},inherit:"concept2",media:{inherit:{type:"exRandom",set:"concept2"}}}]),n.concept1_right=n.concept1_right.concat([{data:{side:"left",handle:"target",alias:a.concept2.name},inherit:"concept2",media:{inherit:{type:"exRandom",set:"concept2"}}},{data:{side:"right",handle:"target",alias:a.concept1.name},inherit:"concept1",media:{inherit:{type:"exRandom",set:"concept1"}}}]);return i={correct:{handle:"correct_feedback",location:{top:80},css:{color:"green","font-size":"4em"},media:{word:"OK"},nolog:!0},error:{handle:"error_feedback",location:{top:80},css:{color:"red","font-size":"4em"},media:{word:"X"},nolog:!0},timeout:{handle:"timeout_feedback",location:{top:80},css:{color:"red","font-size":"4em"},media:{word:"X"},nolog:!0}},n.feedback=[],e.each(["correct","error","timeout"],function(e){var a=i[e];t[e+"_feedback"].css&&(a.css=t[e+"_feedback"].css),t[e+"_feedback"].media&&(a.media=t[e+"_feedback"].media),n.feedback.push(a)}),n}}),define("extensions/iat/data/sequence",["./properties"],function(e){function t(t,a){return e.trialsPerBlock&&"number"==typeof e.trialsPerBlock[t]?e.trialsPerBlock[t]:a}function a(){var a=[],r=[];return i(a,{part:1,block:1,trials:t(1,20),twoRows:!1}),i(a,{part:2,block:2,trials:t(2,20),twoRows:!1}),i(a,{part:3,block:3,trials:t(3,20),twoRows:!0}),i(a,{part:4,block:4,trials:t(4,40),twoRows:!0}),i(a,{part:5,block:5,trials:t(5,40),twoRows:!1}),i(a,{part:6,block:6,trials:t(6,20),twoRows:!0}),i(a,{part:7,block:7,trials:t(7,40),twoRows:!0}),i(r,{part:5,block:1,trials:t(5,20),twoRows:!1}),i(r,{part:2,block:2,trials:t(2,20),twoRows:!1}),i(r,{part:6,block:3,trials:t(6,20),twoRows:!0}),i(r,{part:7,block:4,trials:t(7,40),twoRows:!0}),i(r,{part:1,block:5,trials:t(1,40),twoRows:!1}),i(r,{part:3,block:6,trials:t(3,20),twoRows:!0}),i(r,{part:4,block:7,trials:t(4,40),twoRows:!0}),e.randomize_order?[{mixer:"choose",data:[{mixer:"wrapper",data:a},{mixer:"wrapper",data:r}]}]:a}function r(){var a=[],r=[];return i(a,{part:1,block:1,trials:t(1,20),twoRows:!1}),i(a,{part:2,block:2,trials:t(2,20),twoRows:!1}),i(a,{part:3,block:3,trials:t(3,50),twoRows:!0}),i(a,{part:5,block:4,trials:t(5,30),twoRows:!1}),i(a,{part:6,block:5,trials:t(6,50),twoRows:!0}),i(r,{part:5,block:1,trials:t(5,20),twoRows:!1}),i(r,{part:2,block:2,trials:t(2,20),twoRows:!1}),i(r,{part:6,block:3,trials:t(6,50),twoRows:!0}),i(r,{part:1,block:4,trials:t(1,30),twoRows:!1}),i(r,{part:3,block:5,trials:t(3,50),twoRows:!0}),e.randomize_order?[{mixer:"choose",data:[{mixer:"wrapper",data:a},{mixer:"wrapper",data:r}]}]:a}var i=function(t,a){t.push({data:{part:a.part,block:a.block,IATversion:e.IATversion,blockStart:!0},inherit:{set:"instructions",type:"byData",data:{block:a.block}}}),t.push({mixer:"repeat",times:a.twoRows?Math.floor(a.trials/2):a.trials,data:a.twoRows?[{inherit:{type:"byData",data:{part:a.part,row:1},set:"IAT"},data:{block:a.block}},{inherit:{type:"byData",data:{part:a.part,row:2},set:"IAT"},data:{block:a.block}}]:[{inherit:{type:"byData",data:{part:a.part},set:"IAT"},data:{block:a.block}}]})};return function(){var t="short"==e.IATversion?r():a();return t.push({data:{blockStart:!0},inherit:{set:"instructions",type:"byData",data:{block:"last"}}}),t}}),define("extensions/iat/component",["require","underscore","app/API","./data/properties","./data/categories","./trial/trials","./trial/instructions","./stimuli/stimuli","./data/sequence"],function(e){var t=e("underscore"),a=e("app/API"),r=e("./data/properties"),i=e("./data/categories"),n=e("./trial/trials"),o=e("./trial/instructions"),s=e("./stimuli/stimuli"),c=e("./data/sequence"),l=a.play;return t.extend(a,{setProperties:function(e){t.extend(r,e)},setCategory:function(e,r){var n=["concept1","concept2","attribute1","attribute2"];if(-1===t.indexOf(n,e))throw new Error(e+" is not a valid category name, please use one of the folowing: 'concept1','concept2', 'attribute1', 'attribute2'.");if(r.name||(r.name=e),r.title||(r.title=r.name),!r.media||!r.media.length)throw new Error("You must supply a media list for "+e);a.addMediaSets(e,r.media),i[e]=r},setInstructions:function(){o.apply(this,arguments)},play:function(){a.addSettings("canvas",t.defaults(r.canvas,{background:r.background,canvasBackground:r.background})),a.addSettings("base_url",{image:r.images_base_url,template:r.templates_base_url}),a.addSettings("logger",{pulse:r.pulse,url:r.post_url}),a.addSettings("redirect",r.next_url),a.addTrialSets(n()),a.addStimulusSets(s()),a.addSequence(c()),l.apply(this)}}),a}),define("pipScorer/computeD",["jquery"],function(e){function t(){e.extend(this,{dataArray:{},AnalyzedVar:"latency",ErrorVar:"error",condVar:"",cond1VarValues:[],cond2VarValues:[],parcelVar:"",parcelValue:[],fastRT:300,maxFastTrialsRate:.1,minRT:400,maxRT:1e4,maxErrorParcelRate:.4,errorLatency:{use:"latency",penalty:600,useForSTD:!0},postSettings:{}})}return e.extend(t.prototype,{setComputeObject:function(t){e.extend(this,t)},setDataArray:function(){var e=window.piGlobal;this.dataArray=e.current.logs}}),t}),define("pipScorer/msgMan",["underscore"],function(e){function t(){this.messages=e.extend({},a)}var a={MessageDef:[],manyErrors:"There were too many errors made to determine a result.",tooFast:"There were too many fast trials to determine a result.",notEnough:"There were not enough trials to determine a result."};return e.extend(t.prototype,{setMsgObject:function(t){e.extend(this.messages,t)},getScoreMsg:function(t){var a=this.messages.MessageDef;if(!a||!a.length)throw new Error('You must define a "MessageDef" array.');var r=parseFloat(t),i=null,n=null,o="error: msg was not set",s=!1;if(e.each(a,function(e){i=parseFloat(e.cut),n=e.message,i>=r&&!s&&(o=n,s=!0)}),!s){var c=a.length,l=a[c-1];o=l.message}return o},getMessage:function(e){return this.messages[e]}}),t}),define("pipScorer/parcelMng",["underscore"],function(e){function t(e){this.parcelArray=[],this.scoreData={},this.msgMan=e}return e.extend(t.prototype,{Init:function(t){var a=this,r=this.msgMan,i=window.piGlobal,n=i.current.logs;a.parcelArray=[],a.scoreData={},a.msgMan=r;var o=t.AnalyzedVar,s=t.ErrorVar,c=t.parcelVar,l=t.parcelValue,u=t.minRT,d=t.maxRT,p=t.fastRT,f=0,h=0,m=0,g=0,y=parseFloat(t.maxFastTrialsRate);if("undefined"==typeof l||0===l.length){m=0,f=0,h=0,g=0;var b={};b.name="general",b.trialIData=[],e.each(n,function(e){e[o]>=u&&e[o]<=d?(m++,1==e.data[s]&&g++,a.validate(b,e,t)&&f++):e[o]<=p&&h++}),a.checkErrors(m,g,t),a.parcelArray[0]=b}else e.each(l,function(r,i){m=0,f=0,h=0,g=0;var l={};l.name=r,l.trialIData=[],e.each(n,function(e){var i=e.data[c];i==r&&(e[o]>=u&&e[o]<=d?(m++,1==e.data[s]&&g++,a.validate(l,e,t)&&f++):e[o]<=p&&h++)}),a.checkErrors(m,g,t),a.parcelArray[i]=l});h/f>y&&(a.scoreData.errorMessage=this.msgMan.getMessage("tooFast"))},checkErrors:function(e,t,a){var r=a.maxErrorParcelRate;t/e>r&&(this.scoreData.errorMessage=this.msgMan.getMessage("manyErrors"))},validate:function(e,t,a){var r=a.errorLatency,i=a.ErrorVar,n=t.data;return"latency"==r.use?(e.trialIData.push(t),!0):"false"==r.use?"1"==n[i]?!1:(e.trialIData.push(t),!0):"penalty"==r.use?(e.trialIData.push(t),!0):void 0},addPenalty:function(t,a){var r=a.errorLatency,i=this;if("penalty"==r.use){var n=parseFloat(r.penalty),o=a.ErrorVar,s=a.AnalyzedVar,c=a.condVar,l=a.cond1VarValues,u=a.cond2VarValues,d=t.trialIData,p=t.avgCon1,f=t.avgCon2;e.each(d,function(e){var t=e.data,a=t[o],r=t[c],d=i.checkArray(r,l),h=i.checkArray(r,u);"1"==a&&(d?e[s]+=p+n:h&&(e[s]+=f+n))})}},avgAll:function(t){var a=this;e.each(a.parcelArray,function(e){a.avgParcel(e,t)})},avgParcel:function(t,a){var r=this,i=t.trialIData,n=a.condVar,o=a.cond1VarValues,s=a.cond2VarValues,c=a.AnalyzedVar,l=0,u=0,d=0,p=0,f=0,h=0;e.each(i,function(e){var t=e[c],a=e.data;d+=t,h++;var i=a[n],m=r.checkArray(i,o),g=r.checkArray(i,s);m?(p++,l+=t):g&&(f++,u+=t)}),(2>=p||2>=f)&&(r.scoreData.errorMessage=this.msgMan.getMessage("notEnough")),0!==p&&(l/=p),0!==f&&(u/=f),t.avgCon1=l,t.avgCon2=u,t.diff=t.avgCon1-t.avgCon2,0!==h&&(t.avgBoth=d/h),r.addPenalty(t,a)},checkArray:function(e,t){for(var a=0;a<t.length;a++){var r=t[a];if(r==e)return!0}return!1},varianceAll:function(t){var a=this;e.each(a.parcelArray,function(e){a.varianceParcel(e,t)})},varianceParcel:function(t,a){var r=this,i=a.AnalyzedVar,n=t.trialIData,o=a.cond1VarValues,s=a.cond2VarValues,c=a.condVar,l=t.avgBoth,u=0,d=0,p=[],f=[],h=[],m=a.errorLatency,g=m.useForSTD;e.each(n,function(e){var t=e.data,n=e[i],l=a.ErrorVar,u=t[l],d=t[c],h=r.checkArray(d,o),m=r.checkArray(d,s);h?g?p.push(n):"0"==u&&p.push(n):m&&(g?f.push(n):"0"==u&&p.push(n))}),h=p.concat(f),e.each(h,function(e){var t=e;u=t-l,d+=u*u}),t.variance=d/(h.length-1)},scoreAll:function(t){var a=this,r=0;e.each(a.parcelArray,function(e){a.scoreParcel(e,t),r+=e.score});var i=r/a.parcelArray.length;a.scoreData.score=i.toFixed(2)},scoreParcel:function(e){var t=this,a=Math.sqrt(e.variance);0===a?(t.scoreData.errorMessage=this.msgMan.getMessage("notEnough"),e.score=e.diff):e.score=e.diff/a}}),t}),define("extensions/iat/data/iatScorer",["underscore","pipScorer","./properties","./categories"],function(e,t,a,r){return function(){var i=new t,n=r.attribute1.name,o=r.attribute2.name,s=r.concept1.name,c=r.concept2.name,l={ErrorVar:"score",condVar:"condition",cond1VarValues:[n+"/"+s+","+o+"/"+c],cond2VarValues:[n+"/"+c+","+o+"/"+s],parcelVar:"parcel",parcelValue:["first","second"],fastRT:150,maxFastTrialsRate:.1,minRT:400,maxRT:1e4,errorLatency:{use:"latency",penalty:600,useForSTD:!0},postSettings:{score:"score",msg:"feedback",url:"/implicit/scorer"}},u=[{cut:"-0.65",message:"Your data suggest a strong implicit preference for "+c+" compared to "+s},{cut:"-0.35",message:"Your data suggest a moderate implicit preference for "+c+" compared to "+s},{cut:"-0.15",message:"Your data suggest a slight implicit preference for "+c+" compared to "+s},{cut:"0.15",message:"Your data suggest little to no difference in implicit preference between "+c+" and "+s},{cut:"0.35",message:"Your data suggest a slight implicit preference for "+s+" compared to "+c},{cut:"0.65",message:"Your data suggest a moderate implicit preference for "+s+" compared to "+c},{cut:"3",message:"Your data suggest a strong implicit preference for "+s+" compared to "+c}];return i.addSettings("compute",e.defaults(a.scorerObj||{},l)),i.addSettings("message",{MessageDef:a.scorerMessage||u}),i}}),define("extensions/iat/PIcomponent",["require","underscore","./component","./data/iatScorer"],function(e){var t=e("underscore"),a=e("./component"),r=e("./data/iatScorer"),i=a.play;return a.setProperties({post_url:"/implicit/PiPlayerApplet"}),a.addSettings("logger",{logger:function(){var e=0,t=0,a=function(a,r,i,n){e!=a.block?(e=a.block,t=0):t++;var o=this._stimulus_collection.get_stimlist(),s=this._stimulus_collection.get_medialist();return{log_serial:n.length,trial_id:this.counter,trial_number:t,name:this.name(),responseHandle:r.handle,latency:Math.floor(r.latency),stimuli:o,media:s,data:a}};return a}()}),t.extend(a,{play:function(){var e=r();a.addSettings("hooks",{endTask:function(){var r=t(a.getLogs()).find(function(e){return 3===e.data.block});r=r&&r.data.condition?r.data.condition:"Block 3 condition was not found";var i=e.computeD();e.dynamicPost({score:i.DScore,feedback:i.FBMsg,block3Cond:r}).always(function(){top.location.href="/implicit/Study?tid="+xGetCookie("tid")})}}),i.apply(this)}}),a}),define("text",["module"],function(e){var t,a,r,i,n,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],s=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,c=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,l="undefined"!=typeof location&&location.href,u=l&&location.protocol&&location.protocol.replace(/\:/,""),d=l&&location.hostname,p=l&&(location.port||void 0),f={},h=e.config&&e.config()||{};return t={version:"2.0.12",strip:function(e){if(e){e=e.replace(s,"");var t=e.match(c);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:h.createXhr||function(){var e,t,a;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){a=o[t];try{e=new ActiveXObject(a)}catch(r){}if(e){o=[a];break}}return e},parseName:function(e){var t,a,r,i=!1,n=e.indexOf("."),o=0===e.indexOf("./")||0===e.indexOf("../");return-1!==n&&(!o||n>1)?(t=e.substring(0,n),a=e.substring(n+1,e.length)):t=e,r=a||t,n=r.indexOf("!"),-1!==n&&(i="strip"===r.substring(n+1),r=r.substring(0,n),a?a=r:t=r),{moduleName:t,ext:a,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,a,r,i){var n,o,s,c=t.xdRegExp.exec(e);return c?(n=c[2],o=c[3],o=o.split(":"),s=o[1],o=o[0],!(n&&n!==a||o&&o.toLowerCase()!==r.toLowerCase()||(s||o)&&s!==i)):!0},finishLoad:function(e,a,r,i){r=a?t.strip(r):r,h.isBuild&&(f[e]=r),i(r)},load:function(e,a,r,i){if(i&&i.isBuild&&!i.inlineText)return void r();h.isBuild=i&&i.isBuild;var n=t.parseName(e),o=n.moduleName+(n.ext?"."+n.ext:""),s=a.toUrl(o),c=h.useXhr||t.useXhr;return 0===s.indexOf("empty:")?void r():void(!l||c(s,u,d,p)?t.get(s,function(a){t.finishLoad(e,n.strip,a,r)},function(e){r.error&&r.error(e)}):a([o],function(e){t.finishLoad(n.moduleName+"."+n.ext,n.strip,e,r)}))},write:function(e,a,r){if(f.hasOwnProperty(a)){var i=t.jsEscape(f[a]);r.asModule(e+"!"+a,"define(function () { return '"+i+"';});\n")}},writeFile:function(e,a,r,i,n){var o=t.parseName(a),s=o.ext?"."+o.ext:"",c=o.moduleName+s,l=r.toUrl(o.moduleName+s)+".js";t.load(c,r,function(){var a=function(e){return i(l,e)};a.asModule=function(e,t){return i.asModule(e,l,t)},t.write(e,c,a,n)},n)}},"node"===h.env||!h.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(a=require.nodeRequire("fs"),t.get=function(e,t,r){try{var i=a.readFileSync(e,"utf8");0===i.indexOf("ï»¿")&&(i=i.substring(1)),t(i)}catch(n){r&&r(n)}}):"xhr"===h.env||!h.env&&t.createXhr()?t.get=function(e,a,r,i){var n,o=t.createXhr();if(o.open("GET",e,!0),i)for(n in i)i.hasOwnProperty(n)&&o.setRequestHeader(n.toLowerCase(),i[n]);h.onXhr&&h.onXhr(o,e),o.onreadystatechange=function(){var t,i;4===o.readyState&&(t=o.status||0,t>399&&600>t?(i=new Error(e+" HTTP status: "+t),i.xhr=o,r&&r(i)):a(o.responseText),h.onXhrComplete&&h.onXhrComplete(o,e))},o.send(null)}:"rhino"===h.env||!h.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var a,r,i="utf-8",n=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(n),i)),c="";try{for(a=new java.lang.StringBuffer,r=s.readLine(),r&&r.length()&&65279===r.charAt(0)&&(r=r.substring(1)),null!==r&&a.append(r);null!==(r=s.readLine());)a.append(o),a.append(r);c=String(a.toString())}finally{s.close()}t(c)}:("xpconnect"===h.env||!h.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(r=Components.classes,i=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),n="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var a,o,s,c={};n&&(e=e.replace(/\//g,"\\")),s=new FileUtils.File(e);try{a=r["@mozilla.org/network/file-input-stream;1"].createInstance(i.nsIFileInputStream),a.init(s,1,0,!1),o=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(i.nsIConverterInputStream),o.init(a,"utf-8",a.available(),i.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(a.available(),c),o.close(),a.close(),t(c.value)}catch(l){throw new Error((s&&s.path||"")+": "+l)}}),t}),define("text!extensions/iat/jst/layout.jst",[],function(){return"<div>\n	<% if (stimulusData.attribute) { %>\n		<span style=\"color:<%= stimulusData.attributeColor || '#31b404' %>; font-size:<%= stimulusData.attributeSize || '1.3em'%>\"><%= stimulusData.attribute%></span>\n	<%}%>\n	<% if (stimulusData.attribute && stimulusData.concept) { %>\n		</br>\n		<span style=\"color:<%= stimulusData.separatorColor %>; font-size:<%= stimulusData.separatorSize %>\">or</span>\n		</br>\n	<%}%>\n	<% if (stimulusData.concept) { %>\n		<span style=\"color:<%= stimulusData.conceptColor || '#0000FF' %>; font-size:<%= stimulusData.conceptSize || '1.3em'%>\"><%= stimulusData.concept%></span>\n	<%}%>\n</div>"});
//# sourceMappingURL=PIcomponent.js.map